<div class="section-label" style="font-size: 0.7rem; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; color: #1e3a8a; margin-bottom: 45px; border-bottom: 1px solid #e2e8f0; padding-bottom: 12px;">
    Latest Dispatch.
</div>

<div id="latest-research-container">
    <div class="entry">
        <div class="meta-spine">POLLING...</div>
        <div class="entry-content">
            <h2>Synchronizing with Archive...</h2>
        </div>
    </div>
</div>

<script>
    async function syncLatestDispatch() {
        const container = document.getElementById('latest-research-container');
        const REPO = 'Hadinoori/Hadinoori.github.io';
        
        try {
            const res = await fetch(`https://api.github.com/repos/${REPO}/contents/_insights`);
            const files = await res.json();
            // Sorting to find the absolute newest markdown file
            const newest = files.filter(f => f.name.endsWith('.md')).reverse()[0];

            if (newest) {
                const fileRes = await fetch(newest.download_url);
                const raw = await fileRes.text();
                
                const title = raw.match(/title:\s*"(.*)"/)?.[1] || "Untitled";
                const date = raw.match(/date:\s*(.*)/)?.[1] || "";
                const desc = raw.match(/description:\s*"(.*)"/)?.[1] || "";

                const displayDate = new Date(date).toLocaleDateString('en-US', {month:'short', year:'numeric'}).toUpperCase();

                container.innerHTML = `
                    <div class="entry">
                        <div class="meta-spine">${displayDate} / LATEST</div>
                        <div class="entry-content">
                            <h2 style="font-family: 'Lora', serif; font-size: 2.3rem; line-height: 1.1; letter-spacing: -1px;">${title}</h2>
                            <p style="font-size: 1.15rem; color: #525252; margin-top: 15px; line-height: 1.6; max-width: 60ch;">${desc}</p>
                        </div>
                    </div>
                `;
            }
        } catch (e) { console.error("Dispatch Sync Error", e); }
    }
    window.onload = syncLatestDispatch;
</script>
