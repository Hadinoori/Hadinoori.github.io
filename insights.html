<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insights | Hadi Noori</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Lora:italic,wght@0,700;1,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #fcfcfc;
            --text-primary: #0a0a0a;
            --text-muted: #525252;
            --accent-blue: #1e3a8a; 
            --ui-border: #e2e8f0;
            --font-serif: 'Lora', Georgia, serif;
            --font-sans: 'Inter', sans-serif;
            --spine: 280px; 
        }
        body { background-color: var(--bg-main); font-family: var(--font-sans); color: var(--text-primary); margin: 0; -webkit-font-smoothing: antialiased; }
        .wrap { max-width: 1100px; margin: 0 auto; padding: 0 40px; }
        header { display: flex; justify-content: space-between; align-items: center; padding: 50px 0 30px; border-bottom: 1px solid var(--ui-border); }
        .header-brand { text-decoration: none; color: var(--text-primary); font-size: 0.95rem; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; }
        nav { display: flex; gap: 30px; }
        nav a { text-decoration: none; font-size: 0.8rem; font-weight: 800; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1.5px; }
        nav a.active { color: var(--text-primary); border-bottom: 2px solid var(--text-primary); padding-bottom: 4px; }
        
        .page-title { font-family: var(--font-serif); font-size: 4rem; margin: 80px 0 60px; letter-spacing: -3px; border-bottom: 2px solid var(--text-primary); padding-bottom: 20px; }
        
        /* The structural layout for each row */
        .entry { display: grid; grid-template-columns: var(--spine) 1fr; gap: 80px; padding: 60px 0; border-bottom: 1px solid var(--ui-border); text-decoration: none; color: inherit; transition: background 0.2s; }
        .entry:hover { background: #f9fafb; }
        .meta-spine { font-size: 0.8rem; font-weight: 800; color: var(--text-muted); text-align: right; padding-top: 10px; }
        
        .entry-title { font-family: var(--font-serif); font-size: 2.4rem; line-height: 1.1; margin: 0 0 15px; letter-spacing: -1px; }
        .entry-description { font-size: 1.15rem; color: var(--text-muted); line-height: 1.6; margin: 0; max-width: 55ch; }

        @media (max-width: 900px) { .entry { grid-template-columns: 1fr; gap: 20px; } .meta-spine { text-align: left; } }
    </style>
</head>
<body>
    <div class="wrap">
        <header>
            <a href="/" class="header-brand">Hadi Noori</a>
            <nav>
                <a href="/insights" class="active">Insights</a>
                <a href="/playbooks">Playbooks</a>
                <a href="/dossier">Dossier</a>
                <a href="/contact">Inquiry</a>
            </nav>
        </header>

        <main>
            <h1 class="page-title">Insights.</h1>
            <div id="insights-container">
                <p style="padding: 40px 0; color: var(--text-muted);">Syncing with repository...</p>
            </div>
        </main>
    </div>

    <script>
        async function loadInsights() {
            const container = document.getElementById('insights-container');
            const REPO = 'hadinoori/hadinoori.github.io';
            
            try {
                const res = await fetch(`https://api.github.com/repos/${REPO}/contents/_insights`);
                const files = await res.json();
                const mdFiles = files.filter(f => f.name.endsWith('.md')).reverse();

                container.innerHTML = ''; 

                for (let file of mdFiles) {
                    const fRes = await fetch(file.download_url);
                    const text = await fRes.text();

                    const titleMatch = text.match(/title:\s*["']?(.*?)["']?$/m);
                    const title = titleMatch ? titleMatch[1] : "Strategic Inquiry";
                    
                    const dateMatch = text.match(/date:\s*(.*)/);
                    const date = dateMatch ? dateMatch[1] : "";
                    
                    const descMatch = text.match(/description:\s*["']?(.*?)["']?$/m);
                    const desc = descMatch ? descMatch[1] : "";

                    const extUrlMatch = text.match(/external_url:\s*["']?(.*?)["']?$/m);
                    const externalUrl = extUrlMatch ? extUrlMatch[1] : null;

                    const postSlug = file.name.replace('.md', '');
                    const finalLink = externalUrl ? externalUrl : `/insights/${postSlug}`;
                    
                    const displayDate = new Date(date).toLocaleDateString('en-US', {
                        month: 'short', year: 'numeric'
                    }).toUpperCase();

                    const entryHtml = `
                        <a href="${finalLink}" class="entry" ${externalUrl ? 'target="_blank"' : ''}>
                            <div class="meta-spine">${displayDate} / ${externalUrl ? 'DISPATCH' : 'INSIGHT'}</div>
                            <div class="item-body">
                                <h2 class="entry-title">${title} ${externalUrl ? 'â†—' : ''}</h2>
                                <p class="entry-description">${desc}</p>
                            </div>
                        </a>
                    `;
                    container.insertAdjacentHTML('beforeend', entryHtml);
                }
            } catch (e) {
                container.innerHTML = 'Error loading archive.';
            }
        }
        loadInsights();
    </script>
</body>
</html>
